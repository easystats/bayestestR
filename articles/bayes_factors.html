<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bayestestR">
<title>Bayes Factors • bayestestR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.4/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.4/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.4/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayes Factors">
<meta property="og:description" content="bayestestR">
<meta property="og:image" content="https://easystats.github.io/bayestestR/reference/figures/card.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@easystats4u">
<meta name="twitter:site" content="@easystats4u">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bayestestR</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.13.0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa fa fa-file-code"></span>
     
    Reference
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/bayestestR.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/example1.html">1. Initiation to Bayesian models</a>
    <a class="dropdown-item" href="../articles/example2.html">2. Confirmation of Bayesian skills</a>
    <a class="dropdown-item" href="../articles/example3.html">3. Become a Bayesian master</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/credible_interval.html">Credible Intervals (CI)</a>
    <a class="dropdown-item" href="../articles/region_of_practical_equivalence.html">Region of Practical Equivalence (ROPE)</a>
    <a class="dropdown-item" href="../articles/probability_of_direction.html">Probability of Direction (pd)</a>
    <a class="dropdown-item" href="../articles/bayes_factors.html">Bayes Factors (BF)</a>
    <a class="dropdown-item" href="../articles/web_only/indicesEstimationComparison.html">Comparison of Point-Estimates</a>
    <a class="external-link dropdown-item" href="https://www.frontiersin.org/articles/10.3389/fpsyg.2019.02767/full">Comparison of Indices of Effect Existence</a>
    <a class="dropdown-item" href="../articles/mediation.html">Mediation Analysis: Direct and Indirect Effects</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/guidelines.html">Guidelines</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa fa fa-newspaper"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--easystats" aria-label="easystats">
    <span class="fab fa fab fa-r-project"></span>
     
    easystats
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--easystats">
    <a class="dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/performance/">performance</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/easystats/bayestestR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayes Factors</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/easystats/bayestestR/blob/HEAD/vignettes/bayes_factors.Rmd" class="external-link"><code>vignettes/bayes_factors.Rmd</code></a></small>
      <div class="d-none name"><code>bayes_factors.Rmd</code></div>
    </div>

    
    
<p>This vignette can be referred to by citing the following:</p>
<ul>
<li><p>Makowski, D., Ben-Shachar, M. S., &amp; Lüdecke, D. (2019).
<em>bayestestR: Describing Effects and their Uncertainty, Existence and
Significance within the Bayesian Framework</em>. Journal of Open Source
Software, 4(40), 1541. <a href="https://doi.org/10.21105/joss.01541" class="external-link uri">https://doi.org/10.21105/joss.01541</a></p></li>
<li><p>Makowski, D., Ben-Shachar, M. S., Chen, S. H. A., &amp; Lüdecke,
D. (2019). <em>Indices of Effect Existence and Significance in the
Bayesian Framework</em>. Retrieved from <a href="https://doi.org/10.3389/fpsyg.2019.02767" class="external-link">10.3389/fpsyg.2019.02767</a></p></li>
</ul>
<hr>
<p>The adoption of the Bayesian framework for applied statistics,
especially in the social and psychological sciences, seems to be
developing in two distinct directions. One of the key topics marking
their separation is their opinion about the <strong>Bayes
factor</strong>. In short, one school of thought (e.g., the
<em>Amsterdam school</em>, led by <a href="https://www.bayesianspectacles.org/" class="external-link">E. J. Wagenmakers</a>)
advocate its use, and emphasize its qualities as a statistical index,
while another point to its limits and prefer, instead, the precise
description of posterior distributions (using <a href="https://easystats.github.io/bayestestR/reference/hdi.html">CIs</a>,
<a href="https://easystats.github.io/bayestestR/reference/rope.html">ROPEs</a>,
etc.).</p>
<p>The <code>bayestestR</code> package does <strong>not</strong> take a
side in this debate, and offers tools to carry out analysis irrespective
of the school you subscribe to. Instead, it strongly supports the notion
of an <em>informed choice</em>:</p>
<p><strong>discover the methods, learn about them, understand them, try
them, and decide for yourself</strong>.</p>
<p>Having said that, here’s an introduction to Bayes factors :)</p>
<div class="section level2">
<h2 id="the-bayes-factor">The Bayes Factor<a class="anchor" aria-label="anchor" href="#the-bayes-factor"></a>
</h2>
<p><strong>Bayes Factors (BFs) are indices of <em>relative</em> evidence
of one “model” over another</strong>.</p>
<p>In their role as a hypothesis testing index, they are to Bayesian
framework what a <span class="math inline">\(p\)</span>-value is to the
<strong>classical/frequentist framework</strong>. In significance-based
testing, <span class="math inline">\(p\)</span>-values are used to
assess how unlikely are the observed data if the <strong>null
hypothesis</strong> were true, while in the <strong>Bayesian model
selection framework</strong>, Bayes factors assess evidence for
different models, each model corresponding to a specific hypothesis.</p>
<p>According to Bayes’ theorem, we can update prior probabilities of
some model <span class="math inline">\(M\)</span> (<span class="math inline">\(P(M)\)</span>) to posterior probabilities (<span class="math inline">\(P(M|D)\)</span>) after observing some datum <span class="math inline">\(D\)</span> by accounting for the probability of
observing that datum given the model (<span class="math inline">\(P(D|M)\)</span>, also known as the
<em>likelihood</em>):</p>
<p><span class="math display">\[
P(M|D) = \frac{P(D|M)\times P(M)}{P(D)}
\]</span></p>
<p>Using this equation, we can compare the probability-odds of two
models:</p>
<p><span class="math display">\[
\underbrace{\frac{P(M_1|D)}{P(M_2|D)}}_{\text{Posterior Odds}} =
\underbrace{\frac{P(D|M_1)}{P(D|M_2)}}_{\text{Likelihood Ratio}}
\times
\underbrace{\frac{P(M_1)}{P(M_2)}}_{\text{Prior Odds}}
\]</span></p>
<p>Where the <em>likelihood ratio</em> (the middle term) is the
<em>Bayes factor</em> - it is the <strong><em>factor</em></strong> by
which some <strong>prior odds</strong> have been updated after observing
the data to <strong>posterior odds</strong>.</p>
<p>Thus, Bayes factors can be calculated in two ways:</p>
<ul>
<li>As a ratio quantifying <strong>the relative probability of the
observed data under each of the two models</strong>. (In some contexts,
these probabilities are also called <em>marginal likelihoods</em>.)</li>
</ul>
<p><span class="math display">\[
BF_{12}=\frac{P(D|M_1)}{P(D|M_2)}
\]</span></p>
<ul>
<li>As <strong>the degree of shift in prior beliefs</strong> about the
relative credibility of two models (since they can be computed by
dividing posterior odds by prior odds).</li>
</ul>
<p><span class="math display">\[
BF_{12}=\frac{Posterior~Odds_{12}}{Prior~Odds_{12}}
\]</span></p>
<p>Here we provide functions for computing Bayes factors in two
different contexts:</p>
<ul>
<li><strong>testing single parameters (coefficients) within a
model</strong></li>
<li><strong>comparing statistical models themselves</strong></li>
</ul>
</div>
<div class="section level2">
<h2 id="bayesfactor_parameters">Testing Models’ Parameters with Bayes Factors<a class="anchor" aria-label="anchor" href="#bayesfactor_parameters"></a>
</h2>
<p>A <strong>Bayes factor for a single parameter</strong> can be used to
answer the question:</p>
<blockquote>
<p>“Given the observed data, has the null hypothesis of an absence of an
effect become more or less credible?”</p>
</blockquote>
<div class="figure" style="text-align: center">
<img src="https://github.com/easystats/bayestestR/raw/master/man/figures/deathsticks.jpg" alt="Bayesian analysis of the Students' (1908) Sleep data set." width="80%"><p class="caption">
Bayesian analysis of the Students’ (1908) Sleep data set.
</p>
</div>
<p>Let’s use the Students’ (1908) Sleep data set
(<code>data("sleep")</code>). The data comes from a study in which
participants were administered a drug and the researchers assessed the
extra hours of sleep that participants slept afterwards. We will try
answering the following research question using Bayes factors:</p>
<blockquote>
<p><strong>Given the observed data, has the hypothesis that the drug
(the effect of <code>group</code>) has no effect on the numbers of hours
of extra sleep (variable <code>extra</code>) become more of less
credible?</strong></p>
</blockquote>
<p><img src="bayes_factors_files/figure-html/sleep_boxplot-1.png" width="100%"></p>
<p>The <strong>boxplot</strong> suggests that the second group has a
higher number of hours of extra sleep. <em>By how much?</em></p>
<p>Let’s fit a simple <a href="https://easystats.github.io/bayestestR/articles/example1.html">Bayesian
linear model</a>, with a prior of <span class="math inline">\(b_{group}
\sim N(0, 3)\)</span> (i.e. the prior follows a Gaussian/normal
distribution with <span class="math inline">\(mean = 0\)</span> and
<span class="math inline">\(SD = 3\)</span>), using
<code>rstanarm</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/" class="external-link">rstanarm</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sleep</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, autoscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="testing-against-a-null-region">Testing against a null-<em>region</em><a class="anchor" aria-label="anchor" href="#testing-against-a-null-region"></a>
</h4>
<p>One way of operationlizing the null-hypothesis is by setting a null
region, such that an effect that falls within this interval would be
<em>practically</em> equivalent to the null <span class="citation">(Kruschke, 2010)</span>. In our case, that means
defining a range of effects we would consider equal to the drug having
no effect at all. We can then compute the prior probability of the
drug’s effect falling <em>outside this null-region</em>, and the prior
probability of the drug’s effect falling <em>within the null-region</em>
to get our <em>prior odds</em>. Say any effect smaller than an hour of
extra sleep is practically equivalent to being no effect at all, we
would define our prior odds as:</p>
<p><span class="math display">\[
\frac
{P(b_{drug} \notin [-1, 1])}
{P(b_{drug} \in [-1, 1])}
\]</span></p>
<p>Given our prior has a normal distribution centered at 0 hours with a
scale (an SD) of 3 hours, our priors would look like this:</p>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
<p>and the prior odds would be 2.8.</p>
<p>By looking at the posterior distribution, we can now compute the
posterior probability of the drug’s effect falling <em>outside the
null-region</em>, and the posterior probability of the drug’s effect
falling <em>within the null-region</em> to get our <em>posterior
odds</em>:</p>
<p><span class="math display">\[
\frac
{P(b_{drug} \notin [-1,1] | Data)}
{P(b_{drug} \in [-1,1] | Data)}
\]</span></p>
<p><img src="bayes_factors_files/figure-html/rstanarm_fit-1.png" width="100%"></p>
<p>We can see that the center of the posterior distribution has shifted
away from 0 (to ~1.5). Likewise, the posterior odds are 2.5, which seems
to favor <strong>the effect being non-null</strong>.
<strong>But</strong>, does this mean the data support the alternative
over the null? Hard to say, since even before the data were observed,
the priors already favored the alternative - so we need to take our
priors into account here!</p>
<p>Let’s compute the Bayes factor as the change from the prior odds to
the posterior odds: <span class="math inline">\(BF_{10} =
Odds_{posterior} / Odds_{prior} = 0.9\)</span>! This BF indicates that
the data provide 1/0.9 = 1.1 times more evidence for the effect of the
drug being practically nothing than it does for the drug having some
clinically significant effect. Thus, although the center of distribution
has shifted away from 0, and the posterior distribution seems to favor a
non-null effect of the drug, it seems that given the observed data, the
probability mass has <em>overall</em> shifted closer to the null
interval, making the values in the null interval more probable! <span class="citation">(see <em>Non-overlapping Hypotheses</em> in Morey &amp;
Rouder, 2011)</span></p>
<p>All of this can be achieved with the function
<code><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters()</a></code>, which computes a Bayes factor for
each of the model’s parameters:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">My_first_BF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters</a></span><span class="op">(</span><span class="va">model</span>, null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">My_first_BF</span></span></code></pre></div>
<pre><code>&gt; Bayes Factor (Null-Interval)
&gt; 
&gt; Parameter   |    BF
&gt; -------------------
&gt; (Intercept) | 0.098
&gt; group2      | 0.888
&gt; 
&gt; * Evidence Against The Null: [-1.000, 1.000]</code></pre>
<p>We can also plot using the <code>see</code> package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/" class="external-link">see</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">My_first_BF</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<p>Note that <strong>interpretation guides</strong> for Bayes factors
can be found in the <code>effectsize</code> package:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/interpret_bf.html" class="external-link">interpret_bf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">My_first_BF</span><span class="op">$</span><span class="va">log_BF</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, include_value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; [1] "anecdotal evidence (BF = 1/1.13) against"
&gt; (Rules: jeffreys1961)</code></pre>
</div>
<div class="section level4">
<h4 id="testing-against-the-point-null-0">Testing against the <em>point</em>-null (0)<a class="anchor" aria-label="anchor" href="#testing-against-the-point-null-0"></a>
</h4>
<blockquote>
<p><strong>What if we don’t know what region would be practically
equivalent to 0?</strong></p>
</blockquote>
<p>Or if we just want the null to be exactly zero? Not a problem - as
the width of null region shrinks to a point, the change from the prior
probability to the posterior probability of the null can be estimated by
comparing the density of the null value between the two distributions.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Note that as the width of null interval shrinks to zero,
the prior probability and posterior probability of the alternative tends
towards 1.00.&lt;/p&gt;"><sup>1</sup></a> This ratio
is called the <strong>Savage-Dickey ratio</strong>, and has the added
benefit of also being an approximation of a Bayes factor comparing the
estimated model against a model in which the parameter of interest has
been restricted to a point-null:</p>
<blockquote>
<p>“[…] the Bayes factor for <span class="math inline">\(H_0\)</span>
versus <span class="math inline">\(H_1\)</span> could be obtained by
analytically integrating out the model parameter <span class="math inline">\(\theta\)</span>. However, the Bayes factor may
likewise be obtained by only considering <span class="math inline">\(H_1\)</span>, and dividing the height of the
posterior for <span class="math inline">\(\theta\)</span> by the height
of the prior for <span class="math inline">\(\theta\)</span>, at the
point of interest.” <span class="citation">(Wagenmakers, Lodewyckx,
Kuriyal, &amp; Grasman, 2010)</span></p>
</blockquote>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">My_second_BF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters</a></span><span class="op">(</span><span class="va">model</span>, null <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">My_second_BF</span></span></code></pre></div>
<pre><code>&gt; Bayes Factor (Savage-Dickey density ratio)
&gt; 
&gt; Parameter |   BF
&gt; ----------------
&gt; group2    | 1.26
&gt; 
&gt; * Evidence Against The Null: 0</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">My_second_BF</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="directional-hypotheses">Directional hypotheses<a class="anchor" aria-label="anchor" href="#directional-hypotheses"></a>
</h4>
<p>We can also compute Bayes factors for directional hypotheses (“one
sided”), if we have a prior hypotheses about the direction of the
effect. This can be done by setting an <em>order restriction</em> on the
prior distribution (which results in an order restriction on the
posterior distribution) of the alternative <span class="citation">(Morey
&amp; Wagenmakers, 2014)</span>. For example, if we have a prior
hypothesis that <em>the drug has a positive effect on the number of
sleep hours</em>, the alternative will be restricted to the region to
the right of the null (point or interval):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_group2_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters</a></span><span class="op">(</span><span class="va">model</span>, direction <span class="op">=</span> <span class="st">"&gt;"</span><span class="op">)</span></span>
<span><span class="va">test_group2_right</span></span></code></pre></div>
<pre><code>&gt; Bayes Factor (Savage-Dickey density ratio)
&gt; 
&gt; Parameter |   BF
&gt; ----------------
&gt; group2    | 2.42
&gt; 
&gt; * Evidence Against The Null: 0
&gt; *                 Direction: Right-Sided test</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_group2_right</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-10-1.png" width="100%"></p>
<p>As we can see, given that we have an <em>a priori</em> assumption
about the direction of the effect (that the effect is positive),
<strong>the presence of an effect is 2.8 times more likely than the
absence of an effect</strong>, given the observed data (or that the data
are 2.8 time more probable under <span class="math inline">\(H_1\)</span> than <span class="math inline">\(H_0\)</span>). This indicates that, given the
observed data, and a priori hypothesis, the posterior mass has shifted
away from the null value, giving some evidence against the null (note
that a Bayes factor of 2.8 is still considered quite <a href="https://easystats.github.io/effectsize/reference/interpret_bf.html" class="external-link">weak
evidence</a>).</p>
<p>Thanks to the flexibility of Bayesian framework, it is also possible
to compute a Bayes factor for <strong>dividing</strong> hypotheses -
that is, for a null and alternative that are <em>complementary</em>,
opposing one-sided hypotheses <span class="citation">(Morey &amp;
Wagenmakers, 2014)</span>.</p>
<p>For example, above we compared an alternative of <span class="math inline">\(H_A\)</span>: <em>the drug has a positive
effects</em> to the null <span class="math inline">\(H_0\)</span>:
<em>the drug has no effect</em>. But we can also compare instead the
same alternative to its <em>complementary</em> hypothesis: <span class="math inline">\(H_{-A}\)</span>: <em>the drug has a negative
effects</em>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_group2_dividing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters</a></span><span class="op">(</span><span class="va">model</span>, null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test_group2_dividing</span></span></code></pre></div>
<pre><code>&gt; Bayes Factor (Null-Interval)
&gt; 
&gt; Parameter |    BF
&gt; -----------------
&gt; group2    | 20.75
&gt; 
&gt; * Evidence Against The Null: [-Inf, 0.000]</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_group2_dividing</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<p>We can see that this test produces even stronger (more conclusive)
evidence than the one-sided vs. point-null test! And indeed, as a rule
of thumb, the more specific the two hypotheses are, and the more
distinct they are from one another, the more <em>power</em> our Bayes
factor has! <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;For more, see &lt;a href="https://philstatwars.files.wordpress.com/2020/09/richard_presentation.mp4" class="external-link"&gt;this
talk by Richard D. Morey, minute 48&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a></p>
<p>Thanks to the transitivity of Bayes factors, we can also use
<code><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters()</a></code> to compare even more types of
hypotheses, with some trickery. For example:</p>
<p><span class="math display">\[
\underbrace{BF_{0&lt;b&lt;1\text{ vs. }b=0}}_{\text{range vs. point}}
=
\underbrace{BF_{b&lt;0\text{ vs. }b=0}}_{\text{directional vs. point}}
/
\underbrace{BF_{b&lt;0\text{ vs. }0&lt;b&lt;1}}_{\text{directional vs.
range}}
\]</span></p>
<p><strong>NOTE</strong>: See the <em>Testing Contrasts</em> appendix
below.</p>
</div>
<div class="section level4">
<h4 id="si">Support intervals<a class="anchor" aria-label="anchor" href="#si"></a>
</h4>
<p>So far we’ve seen that Bayes factors quantify relative support
between competing hypotheses. However, we can also ask:</p>
<blockquote>
<p><strong>Upon observing the data, the credibility of which of the
parameter’s values has increased (or decreased)?</strong></p>
</blockquote>
<p>For example, we’ve seen that the point null has become somewhat less
credible after observing the data, but we might also ask which values
have <strong>gained</strong> credibility given the observed data?. The
resulting range of values is called <strong>the support
interval</strong> as it indicates which values are supported by the data
<span class="citation">(Wagenmakers, Gronau, Dablander, &amp; Etz,
2018)</span>. We can do this by once again comparing the prior and
posterior distributions and checking where the posterior densities are
higher than the prior densities.</p>
<p>In <code>bayestestR</code>, this can be achieved with the
<code><a href="../reference/si.html">si()</a></code> function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_first_si</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/si.html">si</a></span><span class="op">(</span></span>
<span>  posterior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group2 <span class="op">=</span> <span class="va">posterior</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group2 <span class="op">=</span> <span class="va">prior</span><span class="op">)</span>,</span>
<span>  BF <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_first_si</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Support Interval
&gt; 
&gt; Parameter |    BF = 1 SI
&gt; ------------------------
&gt; group2    | [0.15, 3.04]</code></pre>
<p>The argument <code>BF = 1</code> indicates that we want the interval
to contain values that have gained support by a factor of at least 1
(that is, any support at all).</p>
<p>Visually, we can see that the credibility of all the values within
this interval has increased (and likewise the credibility of all the
values outside this interval has decreased):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_first_si</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-13-1.png" width="100%"></p>
<p>We can also see the this support interval (just barely) excludes the
point null (0) - whose credibility we’ve already seen has decreased by
the observed data. This emphasizes the relationship between the support
interval and the Bayes factor:</p>
<blockquote>
<p>“The interpretation of such intervals would be analogous to how a
frequentist confidence interval contains all the parameter values that
would not have been rejected if tested at level <span class="math inline">\(\alpha\)</span>. For instance, a BF = 1/3 support
interval encloses all values of theta for which the updating factor is
not stronger than 3 against.” <span class="citation">(Wagenmakers et
al., 2018)</span></p>
</blockquote>
<p>Thus, the choice of BF (the level of support the interval should
indicate) depends on what we want our interval to represent:</p>
<ul>
<li>A <span class="math inline">\(BF = 1\)</span> contains values whose
credibility has merely not decreased by observing the data.</li>
<li>A <span class="math inline">\(BF &gt; 1\)</span> contains values who
received more impressive support from the data.<br>
</li>
<li>A <span class="math inline">\(BF &lt; 1\)</span> contains values
whose credibility has <em>not</em> been impressively decreased by
observing the data. Testing against values outside this interval will
produce a Bayes factor larger than <span class="math inline">\(1/BF\)</span> in support of the alternative.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="bayesfactor_models">Comparing Models using Bayes Factors<a class="anchor" aria-label="anchor" href="#bayesfactor_models"></a>
</h2>
<p>Bayes factors can also be used to compare statistical
<strong>models</strong>. In this statistical context, they answer the
following question:</p>
<blockquote>
<p><strong>Under which model are the observed data more
probable?</strong></p>
</blockquote>
<p>In other words, which model is more likely to have produced the
observed data? This is usually done by comparing the marginal
likelihoods of two models. In such a case, the Bayes factor is a measure
of the <strong>relative</strong> evidence for one model over the
other.</p>
<p>Let’s use Bayes factors for model comparison to find a model that
best describes the length of an iris’ sepal using the <code>iris</code>
data set.</p>
<div class="section level4">
<h4 id="for-bayesian-models-brms-and-rstanarm">For Bayesian models (<code>brms</code> and
<code>rstanarm</code>)<a class="anchor" aria-label="anchor" href="#for-bayesian-models-brms-and-rstanarm"></a>
</h4>
<p><strong>Note: In order to compute Bayes factors for Bayesian models,
non-default arguments must be added upon fitting:</strong></p>
<ul>
<li>
<code>brmsfit</code> models <strong>must</strong> have been fitted
with <code>save_pars = save_pars(all = TRUE)</code>
</li>
<li>
<code>stanreg</code> models <strong>must</strong> have been fitted
with a defined <code>diagnostic_file</code>.</li>
</ul>
<p>Let’s first fit 5 Bayesian regressions with <code>brms</code> to
predict <code>Sepal.Length</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># intercept only model</span></span>
<span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  prior <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 6, 6)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 6)"</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  save_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/save_pars.html" class="external-link">save_pars</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Petal.Length only</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span>,</span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  prior <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 6, 6)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 6)"</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, coef <span class="op">=</span> <span class="st">"Petal.Length"</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  save_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/save_pars.html" class="external-link">save_pars</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Species only</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  prior <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 6, 6)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 6)"</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 3)"</span>, coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Speciesversicolor"</span>, <span class="st">"Speciesvirginica"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  save_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/save_pars.html" class="external-link">save_pars</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Species + Petal.Length model</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">Petal.Length</span>,</span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  prior <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 6, 6)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 6)"</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, coef <span class="op">=</span> <span class="st">"Petal.Length"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 3)"</span>, coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Speciesversicolor"</span>, <span class="st">"Speciesvirginica"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  save_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/save_pars.html" class="external-link">save_pars</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># full interactive model</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span> <span class="op">*</span> <span class="va">Petal.Length</span>,</span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  prior <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 6, 6)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 6)"</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, coef <span class="op">=</span> <span class="st">"Petal.Length"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 3)"</span>, coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Speciesversicolor"</span>, <span class="st">"Speciesvirginica"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 2)"</span>, coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Speciesversicolor:Petal.Length"</span>, <span class="st">"Speciesvirginica:Petal.Length"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  save_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/save_pars.html" class="external-link">save_pars</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can now compare these models with the
<code><a href="../reference/bayesfactor_models.html">bayesfactor_models()</a></code> function, using the
<code>denominator</code> argument to specify the model against which the
rest of the models will be compared (in this case, the intercept-only
model):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/">bayestestR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesfactor_models.html">bayesfactor_models</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span>, denominator <span class="op">=</span> <span class="va">m0</span><span class="op">)</span></span>
<span><span class="va">comparison</span></span></code></pre></div>
<pre><code>&gt; Bayes Factors for Model Comparison
&gt; 
&gt;     Model                        BF
&gt; [1] Petal.Length           1.27e+44
&gt; [2] Species                8.34e+27
&gt; [3] Species + Petal.Length 2.29e+53
&gt; [4] Species * Petal.Length 9.79e+51
&gt; 
&gt; * Against Denominator: [5] (Intercept only)
&gt; *   Bayes Factor Type: marginal likelihoods (bridgesampling)</code></pre>
<p>We can see that the <code>Species + Petal.Length</code> model is the
best model - with <span class="math inline">\(BF=2\times
10^{53}\)</span> compared to the null (intercept only).</p>
<p>Due to the transitive property of Bayes factors, we can easily change
the reference model to the full <code>Species * Petal.Length</code>
model:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">comparison</span>, reference <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Bayes Factors for Model Comparison
&gt; 
&gt;     Model                        BF
&gt; [1] Petal.Length           1.30e-08
&gt; [2] Species                8.52e-25
&gt; [3] Species + Petal.Length    23.38
&gt; [5] (Intercept only)       1.02e-52
&gt; 
&gt; * Against Denominator: [4] Species * Petal.Length
&gt; *   Bayes Factor Type: marginal likelihoods (bridgesampling)</code></pre>
<p>As we can see, the <code>Species + Petal.Length</code> model is also
favored compared to the <code>Species * Petal.Length</code> model,
though to several orders of magnitude less - is is only supported 23.38
times more!)</p>
<p>We can also change the reference model to the <code>Species</code>
model:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">comparison</span>, reference <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Bayes Factors for Model Comparison
&gt; 
&gt;     Model                        BF
&gt; [1] Petal.Length           1.53e+16
&gt; [3] Species + Petal.Length 2.74e+25
&gt; [4] Species * Petal.Length 1.17e+24
&gt; [5] (Intercept only)       1.20e-28
&gt; 
&gt; * Against Denominator: [2] Species
&gt; *   Bayes Factor Type: marginal likelihoods (bridgesampling)</code></pre>
<p>Notice that, in the Bayesian framework the compared models <em>do
not</em> need to be nested models, as happened here when we compared the
<code>Petal.Length</code>-only model to the <code>Species</code>-only
model (something that cannot be done in the frequentist framework, where
compared models must be nested in one another).</p>
<p>We can also get a matrix of Bayes factors of all the pairwise model
comparisons:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; # Bayes Factors for Model Comparison 
&gt; 
&gt;               Numerator
&gt; Denominator
&gt; 
&gt;                 |      [1] |      [2] |      [3] |      [4] |      [5]
&gt; ---------------------------------------------------------------------------------
&gt; [1] Petal.Length           |        1 | 6.54e-17 | 1.80e+09 | 7.68e+07 | 7.85e-45
&gt; [2] Species                | 1.53e+16 |        1 | 2.74e+25 | 1.17e+24 | 1.20e-28
&gt; [3] Species + Petal.Length | 5.57e-10 | 3.64e-26 |        1 |    0.043 | 4.37e-54
&gt; [4] Species * Petal.Length | 1.30e-08 | 8.52e-25 |    23.38 |        1 | 1.02e-52
&gt; [5] (Intercept only)       | 1.27e+44 | 8.34e+27 | 2.29e+53 | 9.79e+51 |        1</code></pre>
<p><strong>NOTE:</strong> In order to correctly and precisely estimate
Bayes Factors, you always need the 4 P’s: <strong>P</strong>roper
<strong>P</strong>riors <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://doi.org/10.1016/j.jmp.2015.08.002" class="external-link"&gt;Robert, 2016&lt;/a&gt;; &lt;a href="https://doi.org/10.1080/01621459.1995.10476572" class="external-link"&gt;Kass &amp;amp;
Raftery, 1993&lt;/a&gt;; &lt;a href="https://doi.org/10.1016/S0304-4076(00)00076-2" class="external-link"&gt;Fernández, Ley,
&amp;amp; Steel, 2001&lt;/a&gt;&lt;/p&gt;'><sup>3</sup></a>, and a <strong>P</strong>lentiful
<strong>P</strong>osterior <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://arxiv.org/abs/1710.08162" class="external-link"&gt;Gronau,
Singmann, &amp;amp; Wagenmakers, 2017&lt;/a&gt;&lt;/p&gt;'><sup>4</sup></a>.</p>
</div>
<div class="section level4">
<h4 id="for-frequentist-models-via-the-bic-approximation">For Frequentist models via the BIC approximation<a class="anchor" aria-label="anchor" href="#for-frequentist-models-via-the-bic-approximation"></a>
</h4>
<p>It is also possible to compute Bayes factors for the comparison of
frequentist models. This is done by comparing BIC measures, allowing a
Bayesian comparison of nested as well as non-nested frequentist models
<span class="citation">(Wagenmakers, 2007)</span>.</p>
<p>Let’s try it out on some <strong>linear mixed-effects
models</strong>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define models with increasing complexity</span></span>
<span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="op">(</span><span class="va">Petal.Length</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="va">Petal.Width</span> <span class="op">+</span> <span class="op">(</span><span class="va">Petal.Length</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">*</span> <span class="va">Petal.Width</span> <span class="op">+</span> <span class="op">(</span><span class="va">Petal.Length</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># model comparison</span></span>
<span><span class="fu"><a href="../reference/bayesfactor_models.html">bayesfactor_models</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span>, denominator <span class="op">=</span> <span class="va">m0</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Bayes Factors for Model Comparison
&gt; 
&gt;      Model                                                       BF
&gt; [m1] Petal.Length + (1 | Species)                          3.82e+25
&gt; [m2] Petal.Length + (Petal.Length | Species)               4.96e+24
&gt; [m3] Petal.Length + Petal.Width + (Petal.Length | Species) 4.03e+23
&gt; [m4] Petal.Length * Petal.Width + (Petal.Length | Species) 9.06e+22
&gt; 
&gt; * Against Denominator: [m0] 1 + (1 | Species)
&gt; *   Bayes Factor Type: BIC approximation</code></pre>
</div>
<div class="section level4">
<h4 id="bayesfactor_restricted">Order restricted models<a class="anchor" aria-label="anchor" href="#bayesfactor_restricted"></a>
</h4>
<p>As stated above when discussing one-sided hypothesis tests, we can
create new models by imposing order restrictions on a given model. For
example, consider the following model, in which we predict the length of
an iris’ sepal from the length of its petal, as well as from its
species, with priors: - <span class="math inline">\(b_{petal} \sim
N(0,2)\)</span> - <span class="math inline">\(b_{versicolors}\
\&amp;\  b_{virginica} \sim N(0,1.2)\)</span></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">Petal.Length</span>,</span>
<span>  data <span class="op">=</span> <span class="va">iris</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span><span class="op">)</span>, autoscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These priors are <strong>unrestricted</strong> - that is, <strong>all
values</strong> between <span class="math inline">\(-\infty\)</span> and
<span class="math inline">\(\infty\)</span> of all parameters in the
model have some non-zero credibility (no matter how small; this is true
for both the prior and posterior distribution). Subsequently, <em>a
priori</em> the ordering of the parameters relating to the iris species
can have any ordering, such that <em>a priori</em> setosa can have
larger sepals than virginica, but it is also possible for virginica to
have larger sepals than setosa!</p>
<p>Does it make sense to let our priors cover all of these
possibilities? That depends on our <em>prior</em> knowledge or
hypotheses. For example, even a novice botanist will assume that it is
unlikely that petal length will be <em>negatively</em> associated with
sepal length - an iris with longer petals is likely larger, and thus
will also have a longer sepal. And an expert botanist will perhaps
assume that setosas have smaller sepals than both versicolors and
virginica.</p>
<p>These priors can be formulated as <strong>restricted</strong> priors
<span class="citation">(Morey, 2015; Morey &amp; Rouder,
2011)</span>:</p>
<ol style="list-style-type: decimal">
<li>The novice botanist: <span class="math inline">\(b_{petal} &gt;
0\)</span>
</li>
<li>The expert botanist: <span class="math inline">\(b_{versicolors}
&gt; 0\ \&amp;\ b_{virginica} &gt; 0\)</span>
</li>
</ol>
<p>By testing these restrictions on prior and posterior samples, we can
see how the probabilities of the restricted distributions change after
observing the data. This can be achieved with
<code><a href="../reference/bayesfactor_restricted.html">bayesfactor_restricted()</a></code>, that compute a Bayes factor for
these restricted model vs the unrestricted model. Let’s first specify
these restrictions as logical conditions:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">botanist_hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Petal.Length &gt; 0"</span>,</span>
<span>  <span class="st">"(Speciesversicolor &gt; 0) &amp; (Speciesvirginica &gt; 0)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Let’s test these hypotheses:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unupdate.html">unupdate</a></span><span class="op">(</span><span class="va">iris_model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">botanist_BFs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesfactor_restricted.html">bayesfactor_restricted</a></span><span class="op">(</span></span>
<span>  posterior <span class="op">=</span> <span class="va">iris_model</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">model_prior</span>,</span>
<span>  hypothesis <span class="op">=</span> <span class="va">botanist_hypotheses</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">botanist_BFs</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Bayes Factor (Order-Restriction)
&gt; 
&gt; Hypothesis                                       P(Prior) P(Posterior)       BF
&gt; Petal.Length &gt; 0                                     0.50            1     2.02
&gt; (Speciesversicolor &gt; 0) &amp; (Speciesvirginica &gt; 0)     0.24            0 0.00e+00
&gt; 
&gt; * Bayes factors for the restricted model vs. the un-restricted model.</code></pre>
<p>We can see that the novice botanist’s hypothesis gets a Bayes factor
of ~2, indicating the data provides twice as much evidence for a model
in which petal length is restricted to be positively associated with
sepal length than for a model with not such restriction.</p>
<p>What about our expert botanist? He seems to have failed miserably,
with a BF favoring the <em>unrestricted</em> model many many times over.
How is this possible? It seems that when <em>controlling for petal
length</em>, versicolor and virginica actually have shorter sepals!</p>
<p><img src="bayes_factors_files/figure-html/plot_iris-1.png" width="100%"></p>
<p>Note that these Bayes factors compare the restricted model to the
unrestricted model. If we wanted to compare the restricted model to the
null model, we could use the transitive property of Bayes factors like
so:</p>
<p><span class="math display">\[
BF_{\text{restricted vs. NULL}} = \frac
{BF_{\text{restricted vs. un-restricted}}}
{BF_{\text{un-restricted vs NULL}}}
\]</span></p>
<p><strong>Because these restrictions are on the prior distribution,
they are only appropriate for testing pre-planned (<em>a priori</em>)
hypotheses, and should not be used for any post hoc comparisons <span class="citation">(Morey, 2015)</span>.</strong></p>
<p><strong>NOTE</strong>: See the <em>Specifying Correct Priors for
Factors with More Than 2 Levels</em> appendix below.</p>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-model-averaging">Bayesian Model Averaging<a class="anchor" aria-label="anchor" href="#bayesian-model-averaging"></a>
</h2>
<p>In the previous section, we discussed the direct comparison of two
models to determine if an effect is supported by the data. However, in
many cases there are too many models to consider, or perhaps it is not
straightforward which models we should compare to determine if an effect
is supported by the data. For such cases, we can use Bayesian model
averaging (BMA) to determine the support provided by the data for a
parameter or term across many models.</p>
<div class="section level4">
<h4 id="bayesfactor_inclusion">Inclusion Bayes factors<a class="anchor" aria-label="anchor" href="#bayesfactor_inclusion"></a>
</h4>
<p>Inclusion Bayes factors answer the question:</p>
<blockquote>
<p><strong>Are the observed data more probable under models with a
particular predictor, than they are under models without that particular
predictor?</strong></p>
</blockquote>
<p>In other words, on average, are models with predictor <span class="math inline">\(X\)</span> more likely to have produced the
observed data than models without predictor <span class="math inline">\(X\)</span>?<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;A model without predictor &lt;span class="math inline"&gt;\(X\)&lt;/span&gt; can be thought of as a model in which
the parameter(s) of the predictor have been restricted to a null-point
of 0.&lt;/p&gt;'><sup>5</sup></a></p>
<p>Since each model has a prior probability, it is possible to sum the
prior probability of all models that include a predictor of interest
(the <em>prior inclusion probability</em>), and of all models that do
not include that predictor (the <em>prior exclusion probability</em>).
After the data are observed, and each model is assigned a posterior
probability, we can similarly consider the sums of the posterior models’
probabilities to obtain the <em>posterior inclusion probability</em> and
the <em>posterior exclusion probability</em>. Once again, the change
from prior inclusion odds to the posterior inclusion odds is the
<strong>Inclusion Bayes factor</strong> [“<span class="math inline">\(BF_{Inclusion}\)</span>”; <span class="citation">Clyde, Ghosh, &amp; Littman (2011)</span>].</p>
<p>Lets use the <code>brms</code> example from above:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesfactor_inclusion.html">bayesfactor_inclusion</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Inclusion Bayes Factors (Model Averaged)
&gt; 
&gt;                      P(prior) P(posterior) Inclusion BF
&gt; Petal.Length             0.60         1.00     1.91e+25
&gt; Species                  0.60         1.00     1.25e+09
&gt; Petal.Length:Species     0.20         0.04        0.171
&gt; 
&gt; * Compared among: all models
&gt; *    Priors odds: uniform-equal</code></pre>
<p>If we examine the interaction term’s inclusion Bayes factor, we can
see that across all 5 models, a model with the term is <em>on
average</em> (1/0.171) 5.84 times less supported than a model without
the term. Note that <code>Species</code>, a factor represented in the
model with several parameters, gets a <em>single</em> Bayes factor -
inclusion Bayes factors are given <strong>per predictor</strong>!</p>
<p>We can also compare only matched models - such that averaging is done
only across models that (1) do not include any interactions with the
predictor of interest; (2) for interaction predictors, averaging is done
only across models that contain the main effects from which the
interaction predictor is comprised (see explanation for why you might
want to do this <a href="https://www.cogsci.nl/blog/interpreting-bayesian-repeated-measures-in-jasp" class="external-link">here</a>).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesfactor_inclusion.html">bayesfactor_inclusion</a></span><span class="op">(</span><span class="va">comparison</span>, match_models <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Inclusion Bayes Factors (Model Averaged)
&gt; 
&gt;                      P(prior) P(posterior) Inclusion BF
&gt; Petal.Length             0.40         0.96     2.74e+25
&gt; Species                  0.40         0.96     1.80e+09
&gt; Petal.Length:Species     0.20         0.04        0.043
&gt; 
&gt; * Compared among: matched models only
&gt; *    Priors odds: uniform-equal</code></pre>
</div>
<div class="section level4">
<h4 id="comparison-with-jasp">Comparison with JASP<a class="anchor" aria-label="anchor" href="#comparison-with-jasp"></a>
</h4>
<p><code><a href="../reference/bayesfactor_inclusion.html">bayesfactor_inclusion()</a></code> is meant to provide Bayes
Factors per predictor, similar to JASP’s <em>Effects</em> option.</p>
<p>Let’s compare the two:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Across all models</strong>:</li>
</ol>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://richarddmorey.github.io/BayesFactor/" class="external-link">BayesFactor</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ToothGrowth</span><span class="op">)</span></span>
<span><span class="va">ToothGrowth</span><span class="op">$</span><span class="va">dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ToothGrowth</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BF_ToothGrowth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BayesFactor/man/anovaBF.html" class="external-link">anovaBF</a></span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span> <span class="op">*</span> <span class="va">supp</span>, <span class="va">ToothGrowth</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/bayesfactor_inclusion.html">bayesfactor_inclusion</a></span><span class="op">(</span><span class="va">BF_ToothGrowth</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Inclusion Bayes Factors (Model Averaged)
&gt; 
&gt;           P(prior) P(posterior) Inclusion BF
&gt; supp          0.60         1.00       140.99
&gt; dose          0.60         1.00     3.21e+14
&gt; dose:supp     0.20         0.72        10.12
&gt; 
&gt; * Compared among: all models
&gt; *    Priors odds: uniform-equal</code></pre>
<p><img src="https://github.com/easystats/bayestestR/raw/master/man/figures/JASP1.jpg" width="100%"></p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Across matched models</strong>:</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesfactor_inclusion.html">bayesfactor_inclusion</a></span><span class="op">(</span><span class="va">BF_ToothGrowth</span>, match_models <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Inclusion Bayes Factors (Model Averaged)
&gt; 
&gt;           P(prior) P(posterior) Inclusion BF
&gt; supp          0.40         0.28        59.19
&gt; dose          0.40         0.28     1.36e+14
&gt; dose:supp     0.20         0.72         2.57
&gt; 
&gt; * Compared among: matched models only
&gt; *    Priors odds: uniform-equal</code></pre>
<p><img src="https://github.com/easystats/bayestestR/raw/master/man/figures/JASP2.jpg" width="100%"></p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>With Nuisance Effects</strong>:</li>
</ol>
<p>We’ll add <code>dose</code> to the null model in JASP, and do the
same in <code>R</code>:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BF_ToothGrowth_against_dose</span> <span class="op">&lt;-</span> <span class="va">BF_ToothGrowth</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">/</span> <span class="va">BF_ToothGrowth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># OR:</span></span>
<span><span class="co"># update(bayesfactor_models(BF_ToothGrowth),</span></span>
<span><span class="co">#        subset = c(4, 5),</span></span>
<span><span class="co">#        reference = 3)</span></span>
<span><span class="va">BF_ToothGrowth_against_dose</span></span></code></pre></div>
<pre><code>&gt; Bayes factor analysis
&gt; --------------
&gt; [1] supp + dose             : 59  ±4.5%
&gt; [2] supp + dose + supp:dose : 152 ±1.5%
&gt; 
&gt; Against denominator:
&gt;   len ~ dose 
&gt; ---
&gt; Bayes factor type: BFlinearModel, JZS</code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesfactor_inclusion.html">bayesfactor_inclusion</a></span><span class="op">(</span><span class="va">BF_ToothGrowth_against_dose</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Inclusion Bayes Factors (Model Averaged)
&gt; 
&gt;           P(prior) P(posterior) Inclusion BF
&gt; dose          1.00         1.00             
&gt; supp          0.67         1.00       105.74
&gt; dose:supp     0.33         0.72         5.06
&gt; 
&gt; * Compared among: all models
&gt; *    Priors odds: uniform-equal</code></pre>
<p><img src="https://github.com/easystats/bayestestR/raw/master/man/figures/JASP3.jpg" width="100%"></p>
</div>
<div class="section level3">
<h3 id="weighted_posteriors">Averaging posteriors<a class="anchor" aria-label="anchor" href="#weighted_posteriors"></a>
</h3>
<p>Similar to how we can average evidence for a predictor across models,
we can also average the <strong>posterior estimate</strong> across
models. This is useful in situations where Bayes factors seem to support
a null effect, yet the <em>HDI</em> for the alternative excludes the
null value (also see <code><a href="../reference/si.html">si()</a></code> described above).</p>
<p>For example, looking at Motor <em>Trend Car Road Tests</em>
(<code>data(mtcars)</code>), we would naturally predict miles/gallon
(<code>mpg</code>) from transition type (<code>am</code>) and weight
(<code>wt</code>), but what about number of carburetors
(<code>carb</code>)? Is this a good predictor?</p>
<p>We can determine this by comparing the following models:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">am</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mtcars</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, autoscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  diagnostic_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"df1.csv"</span><span class="op">)</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_carb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">am</span> <span class="op">+</span> <span class="va">carb</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mtcars</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, autoscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  diagnostic_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"df0.csv"</span><span class="op">)</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">BF_carb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesfactor_models.html">bayesfactor_models</a></span><span class="op">(</span><span class="va">mod_carb</span>, denominator <span class="op">=</span> <span class="va">mod</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">BF_carb</span></span></code></pre></div>
<pre><code>&gt; Bayes Factors for Model Comparison
&gt; 
&gt;     Model             BF
&gt; [1] wt + am + carb 0.811
&gt; 
&gt; * Against Denominator: [2] wt + am
&gt; *   Bayes Factor Type: marginal likelihoods (bridgesampling)</code></pre>
<p>It seems that the model without <code>carb</code> as a predictor is
<span class="math inline">\(1/BF=1.2\)</span> times more likely than the
model <em>with</em> <code>carb</code> as a predictor. We might then
assume that in the latter model, the <code>HDI</code> will include the
point-null value of 0 effect, to also indicate the credibility of the
null in the posterior. However, this is not the case:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hdi.html">hdi</a></span><span class="op">(</span><span class="va">mod_carb</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Highest Density Interval
&gt; 
&gt; Parameter   |        95% HDI
&gt; ----------------------------
&gt; (Intercept) | [28.09, 40.15]
&gt; wt          | [-5.51, -1.74]
&gt; am          | [-1.01,  5.57]
&gt; carb        | [-2.02, -0.35]</code></pre>
<p>How can this be? By estimating the HDI of the effect for
<code>carb</code> in the full model, we are acting under the assumption
that this model is correct. However, as we’ve just seen, both models are
practically tied. If this is the case <strong>why limit our estimation
of the effect just to one model?</strong> <span class="citation">(Bergh,
Haaf, Ly, Rouder, &amp; Wagenmakers, 2019)</span>.</p>
<p>Using Bayesian Model Averaging, we can combine the posteriors samples
from several models, weighted by the models’ marginal likelihood (done
via the <code><a href="../reference/bayesfactor_models.html">bayesfactor_models()</a></code> function). If some parameter
is part of some of the models but is missing from others, it is assumed
to be fixed a 0 (which can also be seen as a method of applying
shrinkage to our estimates). This results in a posterior distribution
across several models, which we can now treat like any posterior
distribution, and estimate the HDI.</p>
<p>In <code>bayestestR</code>, we can do this with the
<code><a href="../reference/weighted_posteriors.html">weighted_posteriors()</a></code> function:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BMA_draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weighted_posteriors.html">weighted_posteriors</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">mod_carb</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BMA_hdi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hdi.html">hdi</a></span><span class="op">(</span><span class="va">BMA_draws</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">BMA_hdi</span></span></code></pre></div>
<pre><code>&gt; Highest Density Interval
&gt; 
&gt; Parameter   |        95% HDI
&gt; ----------------------------
&gt; (Intercept) | [29.18, 42.48]
&gt; wt          | [-6.64, -2.15]
&gt; am          | [-2.74,  5.03]
&gt; carb        | [-1.68,  0.00]</code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">BMA_hdi</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-23-1.png" width="100%"></p>
<p>We can see that across both models under consideration, the posterior
of the <code>carb</code> effect is almost equally weighted between the
alternative model and the null model - as represented by about half of
the posterior mass concentrated at 0 - which makes sense as both models
were almost equally supported by the data. We can also see that across
both models, that now <strong>the HDI does contain 0</strong>. Thus we
have resolved the conflict between the Bayes factor and the HDI <span class="citation">(Rouder, Haaf, &amp; Vandekerckhove, 2018)</span>!</p>
<p><strong>Note</strong>: Parameters might play different roles across
different models.</p>
<p>For example, the parameter <code>A</code> plays a different role in
the model <code>Y ~ A + B</code> (where it is a <em>main</em> effect)
than it does in the model <code>Y ~ A + B + A:B</code> (where it is a
<em>simple</em> effect). In many cases centering of predictors (mean
subtracting for continuous variables, and orthogonal coding for factors)
can in some cases reduce this issue.</p>
</div>
</div>
<div class="section level2">
<h2 id="appendices">Appendices<a class="anchor" aria-label="anchor" href="#appendices"></a>
</h2>
<div class="section level3">
<h3 id="testing-contrasts-with-emmeans-modelbased">Testing contrasts (with <code>emmeans</code> /
<code>modelbased</code>)<a class="anchor" aria-label="anchor" href="#testing-contrasts-with-emmeans-modelbased"></a>
</h3>
<p>Besides testing parameter <code><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters()</a></code> can
be used to test any estimate based on the prior and posterior
distribution of the estimate. One way to achieve this is with a mix of
<code><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters()</a></code> + <a href="https://cran.r-project.org/package=emmeans" class="external-link"><strong><code>emmeans</code></strong></a>
to <a href="https://easystats.github.io/blog/posts/bayestestr_emmeans/" class="external-link">test
Bayesian contrasts</a>.</p>
<p>For example, in the <code>sleep</code> example from above, we can
estimate the group means and the difference between them:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans" class="external-link">emmeans</a></span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">group_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">pairwise</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; $emmeans
&gt;  group emmean lower.HPD upper.HPD
&gt;  1       0.79     -0.48       2.0
&gt;  2       2.28      1.00       3.5
&gt; 
&gt; Point estimate displayed: median 
&gt; HPD interval probability: 0.95 
&gt; 
&gt; $contrasts
&gt;  contrast        estimate lower.HPD upper.HPD
&gt;  group1 - group2    -1.47      -3.2     0.223
&gt; 
&gt; Point estimate displayed: median 
&gt; HPD interval probability: 0.95</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pass the original model via prior</span></span>
<span><span class="fu"><a href="../reference/bayesfactor_parameters.html">bayesfactor_parameters</a></span><span class="op">(</span><span class="va">group_diff</span>, prior <span class="op">=</span> <span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Bayes Factor (Savage-Dickey density ratio)
&gt; 
&gt; Parameter       |    BF
&gt; -----------------------
&gt; 1               | 0.287
&gt; 2               | 19.97
&gt; group1 - group2 |  1.26
&gt; 
&gt; * Evidence Against The Null: 0</code></pre>
<p>That is strong evidence for the mean of group 1 being 0, and for
group 2 for not being 0, but hardly any evidence for the difference
between them being not 0. Conflict? Uncertainty? That is the Bayesian
way!</p>
<p>We can also use the <code>easystats</code>’ <a href="https://cran.r-project.org/package=modelbased" class="external-link"><strong><code>modelbased</code></strong></a>
package to compute Bayes factors for contrasts:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/modelbased/" class="external-link">modelbased</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_contrasts.html" class="external-link">estimate_contrasts</a></span><span class="op">(</span><span class="va">model</span>, test <span class="op">=</span> <span class="st">"bf"</span>, bf_prior <span class="op">=</span> <span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p><strong>NOTE</strong>: See the <em>Specifying Correct Priors for
Factors with More Than 2 Levels</em> section below.</p>
</div>
<div class="section level3">
<h3 id="contr_bayes">Specifying correct priors for factors<a class="anchor" aria-label="anchor" href="#contr_bayes"></a>
</h3>
<p>This section introduces the biased priors obtained when using the
common <em>effects</em> factor coding (<code>contr.sum</code>) or dummy
factor coding (<code>contr.treatment</code>), and the solution of using
orthonormal factor coding (<code>contr.equalprior</code>) <span class="citation">(as outlined in Rouder, Morey, Speckman, &amp;
Province, 2012, sec. 7.2)</span>.</p>
<p><strong>Special care should be taken when working with factors with 3
or more levels</strong>.</p>
<div class="section level4">
<h4 id="contrasts-and-marginal-means">Contrasts (and marginal means)<a class="anchor" aria-label="anchor" href="#contrasts-and-marginal-means"></a>
</h4>
<p>The <em>effects</em> factor coding commonly used in factorial
analysis carries a hidden bias when it is applies to Bayesian priors.
For example, if we want to test all pairwise differences between 3
levels of the same factor, we would expect all <em>a priori</em>
differences to have the same distribution, but…</p>
<p>For our example, we will be test all <strong><em>prior</em></strong>
pairwise differences between the 3 species in the <code>iris</code>
dataset.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">iris</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">contr.sum</span></span>
<span></span>
<span><span class="va">fit_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, autoscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  prior_PD <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># sample priors</span></span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pairs_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">fit_sum</span>, <span class="op">~</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt;  contrast               estimate lower.HPD upper.HPD
&gt;  setosa - versicolor      -0.017      -2.8       2.7
&gt;  setosa - virginica       -0.027      -4.0       4.6
&gt;  versicolor - virginica    0.001      -4.2       4.5
&gt; 
&gt; Point estimate displayed: median 
&gt; HPD interval probability: 0.95</code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="fu">insight</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/insight/reference/get_parameters.html" class="external-link">get_parameters</a></span><span class="op">(</span><span class="va">pairs_sum</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">values</span>, fill <span class="op">=</span> <span class="va">ind</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">ind</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"prior difference values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-30-1.png" width="100%"></p>
<p>Notice that, though the prior estimate for all 3 pairwise contrasts
is ~0, the scale or the HDI is much narrower for the prior of the
<code>setosa - versicolor</code> contrast!</p>
<p><strong>What happened???</strong></p>
<p>This is caused by an inherent bias in the priors introduced by the
<em>effects</em> coding (it’s even worse with the default treatment
coding, because the prior for the intercept is usually drastically
different from the effect’s parameters). <strong>And since it affects
the priors, this bias will also bias the Bayes factors over /
understating evidence for some contrasts over others!</strong></p>
<p>The solution is to use <em>equal-prior</em> factor coding, a-la the
<code>contr.equalprior*</code> family, which can either specify this
factor coding per-factor:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">contr.equalprior_pairs</span></span></code></pre></div>
<p>Or you can set it globally:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contr.equalprior_pairs"</span>, <span class="st">"contr.poly"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s again estimate the <strong><em>prior</em></strong>
differences:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, autoscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  prior_PD <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># sample priors</span></span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">pairs_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">fit_bayes</span>, <span class="op">~</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt;  contrast               estimate lower.HPD upper.HPD
&gt;  setosa - versicolor      0.0000     -2.10      1.89
&gt;  setosa - virginica       0.0228     -1.93      1.99
&gt;  versicolor - virginica   0.0021     -2.06      1.89
&gt; 
&gt; Point estimate displayed: median 
&gt; HPD interval probability: 0.95</code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="fu">insight</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/insight/reference/get_parameters.html" class="external-link">get_parameters</a></span><span class="op">(</span><span class="va">pairs_bayes</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">values</span>, fill <span class="op">=</span> <span class="va">ind</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">ind</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"prior difference values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bayes_factors_files/figure-html/unnamed-chunk-35-1.png" width="100%"></p>
<p>We can see that using the <code>contr.equalprior_pairs</code> coding
scheme, we have equal priors on all pairwise contrasts, with the width
corresponding to the <code>normal(0, c(1, 1), autoscale = FALSE)</code>
prior we set!</p>
<p>There are other solutions to this problem of priors. You can read
about them in <a href="https://solomonkurz.netlify.app/post/2020-12-09-multilevel-models-and-the-index-variable-approach/" class="external-link">Solomon
Kurz’s blog post</a>.</p>
</div>
<div class="section level4">
<h4 id="order-restrictions">Order restrictions<a class="anchor" aria-label="anchor" href="#order-restrictions"></a>
</h4>
<p>This bias also affect order restrictions involving 3 or more levels.
For example, if we want to test an order restriction among A, B, and C,
the <em>a priori</em> probability of obtaining the order A &gt; C &gt; B
is 1/6 (reach back to <em>intro to stats</em> year 1), but…</p>
<p>For our example, we will be interested in the following order
restrictions in the <code>iris</code> dataset (each line is a separate
restriction):</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hyp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="co"># comparing 2 levels</span></span>
<span>  <span class="st">"setosa &lt; versicolor"</span>,</span>
<span>  <span class="st">"setosa &lt; virginica"</span>,</span>
<span>  <span class="st">"versicolor &lt; virginica"</span>,</span>
<span></span>
<span>  <span class="co"># comparing 3 (or more) levels</span></span>
<span>  <span class="st">"setosa    &lt; virginica  &amp; virginica  &lt; versicolor"</span>,</span>
<span>  <span class="st">"virginica &lt; setosa     &amp; setosa     &lt; versicolor"</span>,</span>
<span>  <span class="st">"setosa    &lt; versicolor &amp; versicolor &lt; virginica"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With the default factor coding, this looks like this:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">contr.sum</span></span>
<span></span>
<span><span class="va">fit_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, autoscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">em_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">fit_sum</span>, <span class="op">~</span><span class="va">Species</span><span class="op">)</span> <span class="co"># the posterior marginal means</span></span>
<span></span>
<span><span class="fu"><a href="../reference/bayesfactor_restricted.html">bayesfactor_restricted</a></span><span class="op">(</span><span class="va">em_sum</span>, <span class="va">fit_sum</span>, hypothesis <span class="op">=</span> <span class="va">hyp</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; 
&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
&gt; Chain 1: 
&gt; Chain 1: Gradient evaluation took 2.4e-05 seconds
&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.24 seconds.
&gt; Chain 1: Adjust your expectations accordingly!
&gt; Chain 1: 
&gt; Chain 1: 
&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
&gt; Chain 1: 
&gt; Chain 1:  Elapsed Time: 0.031535 seconds (Warm-up)
&gt; Chain 1:                0.052594 seconds (Sampling)
&gt; Chain 1:                0.084129 seconds (Total)
&gt; Chain 1: 
&gt; 
&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
&gt; Chain 2: 
&gt; Chain 2: Gradient evaluation took 1.5e-05 seconds
&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.15 seconds.
&gt; Chain 2: Adjust your expectations accordingly!
&gt; Chain 2: 
&gt; Chain 2: 
&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
&gt; Chain 2: 
&gt; Chain 2:  Elapsed Time: 0.032364 seconds (Warm-up)
&gt; Chain 2:                0.047718 seconds (Sampling)
&gt; Chain 2:                0.080082 seconds (Total)
&gt; Chain 2: 
&gt; 
&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
&gt; Chain 3: 
&gt; Chain 3: Gradient evaluation took 1.5e-05 seconds
&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.15 seconds.
&gt; Chain 3: Adjust your expectations accordingly!
&gt; Chain 3: 
&gt; Chain 3: 
&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
&gt; Chain 3: 
&gt; Chain 3:  Elapsed Time: 0.031697 seconds (Warm-up)
&gt; Chain 3:                0.046272 seconds (Sampling)
&gt; Chain 3:                0.077969 seconds (Total)
&gt; Chain 3: 
&gt; 
&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
&gt; Chain 4: 
&gt; Chain 4: Gradient evaluation took 1.5e-05 seconds
&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.15 seconds.
&gt; Chain 4: Adjust your expectations accordingly!
&gt; Chain 4: 
&gt; Chain 4: 
&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
&gt; Chain 4: 
&gt; Chain 4:  Elapsed Time: 0.030791 seconds (Warm-up)
&gt; Chain 4:                0.0475 seconds (Sampling)
&gt; Chain 4:                0.078291 seconds (Total)
&gt; Chain 4:</code></pre>
<pre><code>&gt; Bayes Factor (Order-Restriction)
&gt; 
&gt; Hypothesis                                       P(Prior) P(Posterior)       BF
&gt; setosa &lt; versicolor                                  0.51            1     1.97
&gt; setosa &lt; virginica                                   0.49            1     2.02
&gt; versicolor &lt; virginica                               0.49            1     2.03
&gt; setosa    &lt; virginica  &amp; virginica  &lt; versicolor     0.11            0 0.00e+00
&gt; virginica &lt; setosa     &amp; setosa     &lt; versicolor     0.20            0 0.00e+00
&gt; setosa    &lt; versicolor &amp; versicolor &lt; virginica      0.20            1     5.09
&gt; 
&gt; * Bayes factors for the restricted model vs. the un-restricted model.</code></pre>
<p><strong><em>What happened???</em></strong></p>
<ol style="list-style-type: decimal">
<li>The comparison of 2 levels all have a prior of ~0.5, as
expected.<br>
</li>
<li>The comparison of 3 levels has different priors, depending on the
order restriction - i.e. <strong>some orders are <em>a priori</em> more
likely than others!!!</strong>
</li>
</ol>
<p>Again, this is solved by using the <em>equal prior</em> factor coding
(from above).</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">contr.equalprior_pairs</span></span>
<span></span>
<span><span class="va">fit_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, autoscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="va">em_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">fit_sum</span>, <span class="op">~</span><span class="va">Species</span><span class="op">)</span> <span class="co"># the posterior marginal means</span></span>
<span><span class="fu"><a href="../reference/bayesfactor_restricted.html">bayesfactor_restricted</a></span><span class="op">(</span><span class="va">em_bayes</span>, <span class="va">fit_sum</span>, hypothesis <span class="op">=</span> <span class="va">hyp</span><span class="op">)</span></span></code></pre></div>
<pre><code>&gt; Bayes Factor (Order-Restriction)
&gt; 
&gt; Hypothesis                                       P(Prior) P(Posterior)       BF
&gt; setosa &lt; versicolor                                  0.49            1     2.06
&gt; setosa &lt; virginica                                   0.49            1     2.03
&gt; versicolor &lt; virginica                               0.51            1     1.96
&gt; setosa    &lt; virginica  &amp; virginica  &lt; versicolor     0.17            0 0.00e+00
&gt; virginica &lt; setosa     &amp; setosa     &lt; versicolor     0.16            0 0.00e+00
&gt; setosa    &lt; versicolor &amp; versicolor &lt; virginica      0.16            1     6.11
&gt; 
&gt; * Bayes factors for the restricted model vs. the un-restricted model.</code></pre>
</div>
<div class="section level4">
<h4 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h4>
<p>When comparing the results from the two factor coding schemes, we
find:<br>
1. In both cases, the estimated (posterior) means are quite similar (if
not identical).<br>
2. The priors and Bayes factors differ between the two schemes.<br>
3. Only with <code>contr.equalprior*</code>, the prior distribution of
the difference or the order of 3 (or more) means is balanced.</p>
<p>Read more about the equal prior contrasts in the
<code>contr.equalprior</code> docs!</p>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-van2019cautionary" class="csl-entry">
Bergh, D. van den, Haaf, J. M., Ly, A., Rouder, J. N., &amp;
Wagenmakers, E.-J. (2019). <em>A cautionary note on estimating effect
size</em>.
</div>
<div id="ref-clyde2011bayesian" class="csl-entry">
Clyde, M. A., Ghosh, J., &amp; Littman, M. L. (2011). Bayesian adaptive
sampling for variable selection and model averaging. <em>Journal of
Computational and Graphical Statistics</em>, <em>20</em>(1), 80–101.
</div>
<div id="ref-kruschke2010believe" class="csl-entry">
Kruschke, J. K. (2010). What to believe: Bayesian methods for data
analysis. <em>Trends in Cognitive Sciences</em>, <em>14</em>(7),
293–300.
</div>
<div id="ref-morey_2015_blog" class="csl-entry">
Morey, R. D. (2015). <em>Multiple comparisons with BayesFactor, part 2 –
order restrictions</em>. Retrieved from <a href="http://bayesfactor.blogspot.com/2015/01/multiple-comparisons-with-bayesfactor-2.html" class="external-link">http://bayesfactor.blogspot.com/2015/01/multiple-comparisons-with-bayesfactor-2.html</a>
</div>
<div id="ref-morey2011bayesinterval" class="csl-entry">
Morey, R. D., &amp; Rouder, J. N. (2011). Bayes factor approaches for
testing interval null hypotheses. <em>Psychological Methods</em>,
<em>16</em>(4), 406.
</div>
<div id="ref-morey2014simple" class="csl-entry">
Morey, R. D., &amp; Wagenmakers, E.-J. (2014). Simple relation between
bayesian order-restricted and point-null hypothesis tests.
<em>Statistics &amp; Probability Letters</em>, <em>92</em>, 121–124.
</div>
<div id="ref-rouder2018bayesian" class="csl-entry">
Rouder, J. N., Haaf, J. M., &amp; Vandekerckhove, J. (2018). Bayesian
inference for psychology, part IV: Parameter estimation and bayes
factors. <em>Psychonomic Bulletin &amp; Review</em>, <em>25</em>(1),
102–113.
</div>
<div id="ref-rouder2012default" class="csl-entry">
Rouder, J. N., Morey, R. D., Speckman, P. L., &amp; Province, J. M.
(2012). Default bayes factors for ANOVA designs. <em>Journal of
Mathematical Psychology</em>, <em>56</em>(5), 356–374.
</div>
<div id="ref-wagenmakers2007practical" class="csl-entry">
Wagenmakers, E.-J. (2007). A practical solution to the pervasive
problems ofp values. <em>Psychonomic Bulletin &amp; Review</em>,
<em>14</em>(5), 779–804.
</div>
<div id="ref-wagenmakers2018SI" class="csl-entry">
Wagenmakers, E.-J., Gronau, Q. F., Dablander, F., &amp; Etz, A. (2018).
<em>The support interval</em>. <a href="https://doi.org/10.31234/osf.io/zwnxb" class="external-link">https://doi.org/10.31234/osf.io/zwnxb</a>
</div>
<div id="ref-wagenmakers2010bayesian" class="csl-entry">
Wagenmakers, E.-J., Lodewyckx, T., Kuriyal, H., &amp; Grasman, R.
(2010). Bayesian hypothesis testing for psychologists: A tutorial on the
savage–dickey method. <em>Cognitive Psychology</em>, <em>60</em>(3),
158–189.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, <a href="http://www.humanfactors.io" class="external-link">Michael D. Wilson</a>, <a href="https://wiernik.org/" class="external-link">Brenton M. Wiernik</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
